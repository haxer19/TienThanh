local Configs = {}

do 
    Configs.select=nil
    Configs.esp=false
    Configs.autofarm=false
    Configs.autofly=false
    Configs.walkspeed=16
    Configs.flyspeed=100
end

plotid=game.Players.LocalPlayer:GetAttribute("PlotId")



local function tp(player, target)
    local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
    if not hrp or not target then return end

    local pos

    if typeof(target) == "CFrame" then
        pos = target.Position

    elseif typeof(target) == "Vector3" then
        pos = target

    elseif typeof(target) == "Instance" then
        if target:IsA("Model") then
            pos = target:GetPivot().Position

        elseif target:IsA("BasePart") or target:IsA("Attachment") then
            pos = target.Position

        elseif target:IsA("ObjectValue") and target.Value then
            return tp(player, target.Value)

        elseif target:FindFirstChildWhichIsA("BasePart") then
            return tp(player, target:FindFirstChildWhichIsA("BasePart"))

        elseif target:FindFirstChild("Position") and typeof(target.Position) == "Vector3" then
            pos = target.Position
        end
    end

    if pos then
        hrp.CFrame = CFrame.new(pos)
    end
end




local function getOreNames()
    local t, m = {}, {}
    for _, v in ipairs(workspace:WaitForChild("PlacedOre"):GetChildren()) do
        local n = v.Name
        if not m[n] then
            t[#t+1] = n
            m[n] = true
        end
    end
    return t
end

local ores = getOreNames()







local rs = game:GetService("RunService")
local oreFolder = workspace:WaitForChild("PlacedOre")
local cam = workspace.CurrentCamera
local p = game.Players.LocalPlayer
local espList, espCon, hue = {}, nil, 0
local rainbow = false

local function clearESP()
	for _, v in pairs(espList) do
		if v.box then v.box:Destroy() end
		if v.label then v.label:Destroy() end
	end
	espList = {}
end

local function isAlreadyESP(part)
	for _, v in ipairs(espList) do
		if v.part == part then return true end
	end
	return false
end

local function addESPToPart(part)
	local box = Instance.new("BoxHandleAdornment")
	box.Adornee = part
	box.AlwaysOnTop = true
	box.ZIndex = 10
	box.Size = part.Size
	box.Transparency = 0.2
	box.Name = "ore"
	box.Color3 = Color3.fromRGB(0, 255, 255)
	box.Parent = part

	local label = Instance.new("BillboardGui")
	label.Adornee = part
	label.AlwaysOnTop = true
	label.Size = UDim2.new(0, 50, 0, 10)
	label.StudsOffset = Vector3.new(0, part.Size.Y + 0.5, 0)
	label.Parent = part

	local text = Instance.new("TextLabel")
	text.Text = ""
	text.Size = UDim2.new(1, 0, 1, 0)
	text.BackgroundTransparency = 1
	text.TextColor3 = Color3.fromRGB(0, 255, 127)
	text.Font = Enum.Font.Code
	text.TextScaled = false
	text.TextSize = 11
	text.TextStrokeTransparency = 0.8
	text.Parent = label

	table.insert(espList, {box = box, label = label, text = text, part = part})
end

local function OreESP(oreName)
	if espCon then espCon:Disconnect() end

	espCon = rs.RenderStepped:Connect(function()
		hue = (hue + 0.002) % 1
		local plrPos = p.Character and p.Character:FindFirstChild("HumanoidRootPart") and p.Character.HumanoidRootPart.Position

        
		for _, ore in ipairs(oreFolder:GetChildren()) do
			if ore.Name == oreName then
				local parts = {}
				if ore:IsA("Model") then
					for _, v in ipairs(ore:GetDescendants()) do
						if v:IsA("BasePart") and not isAlreadyESP(v) then
							addESPToPart(v)
						end
					end
				elseif ore:IsA("BasePart") and not isAlreadyESP(ore) then
					addESPToPart(ore)
				end
			end
		end

		for _, v in ipairs(espList) do
			if v.box and v.box.Parent and v.text and v.label and v.part then
				if rainbow then
					v.box.Color3 = Color3.fromHSV(hue, 0.6, 1)
				end

				if plrPos and v.part:IsDescendantOf(workspace) then
					local dist = math.floor((v.part.Position - plrPos).Magnitude)
					v.text.Text = dist .. "m"
				end
			end
		end
	end)
end








local p, rs, oref, run = game.Players.LocalPlayer, game:GetService("RunService"), workspace:WaitForChild("PlacedOre"), false

local function getRandOre()
    local o = oref:GetChildren()
    return o[math.random(1, #o)]
end

local function setNoClip(state)
    local chr = p.Character
    if not chr then return end
    for _, part in ipairs(chr:GetDescendants()) do
        if part:IsA("BasePart") then
            part.CanCollide = not state
        end
    end
end

local function flyToOre()
    local h = p.Character and p.Character:FindFirstChild("HumanoidRootPart")
    if not h then return end

    local origin = h.CFrame
    local target = getRandOre()
    if not target then return end

    local pos = target:IsA("Model") and target:GetPivot().Position or target.Position
    run = true

    local con
    con = rs.Stepped:Connect(function()
        if not run then con:Disconnect() return end
        setNoClip(true)
        local dir = (pos - h.Position).Unit
        h.Velocity = dir * Configs.flyspeed
        if (h.Position - pos).Magnitude <= 5 then
            run = false
            h.Velocity = Vector3.zero
            task.wait(0.1)
            h.CFrame = origin
            setNoClip(false)
            con:Disconnect()
        end
    end)
end




local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()


function gradient(text, startColor, endColor)
    local result = ""
    local length = #text
    for i = 1, length do
        local t = (i - 1) / math.max(length - 1, 1)
        local r = math.floor((startColor.R + (endColor.R - startColor.R) * t) * 255)
        local g = math.floor((startColor.G + (endColor.G - startColor.G) * t) * 255)
        local b = math.floor((startColor.B + (endColor.B - startColor.B) * t) * 255)
        local char = text:sub(i, i)
        result = result .. "<font color=\"rgb(" .. r ..", " .. g .. ", " .. b .. ")\">" .. char .. "</font>"
    end
    return result
end

local Confirmed = false

WindUI:Popup({
    Title = "Hi " .. game.Players.LocalPlayer.DisplayName .. " !!",
    Icon = "rbxassetid://101602269941993",
    IconThemed = true,
    Content = gradient(" Tien Thanh Vip Vo Co Lo HI HI HI ", Color3.fromHex("#00F5FF"), Color3.fromHex("#C86BFF")),
    Buttons = {
        {
            Title = "Cancel",
            Callback = function() end,
            Variant = "Secondary",
        },
        {
            Title = "Continue",
            Icon = "arrow-right",
            Callback = function() Confirmed = true end,
            Variant = "Primary",
        }
    }
})

repeat wait() until Confirmed

local Window = WindUI:CreateWindow({
    Title = "Ultimate Mining Tycoon",
    Icon = "rbxassetid://101602269941993",
    IconThemed = false,
    Author = "xhk",
    Folder = "Haxer19",
    Size = UDim2.fromOffset(530,340),
    Theme = "Dark",
    SideBarWidth = 140,
    HideSearchBar = true,
    ToggleKey = Enum.KeyCode.RightControl,
})

WindUI:AddTheme({
    Name = "xhk",
    Accent = "#00F5FF",            
    Outline = "#1E0F29",         
    Background = "#120A1A",        
    SecondaryBackground = "#1B1230",
    Text = "#E5F7FF",               
    PlaceholderText = "#A77BFF"   
})

WindUI:SetTheme("xhk")


Window:EditOpenButton({
    Title = "OPEN | xhk",
    Icon = "rbxassetid://101602269941993",
    CornerRadius = UDim.new(0,10),
    StrokeThickness = 2,
    Color = ColorSequence.new(
        Color3.fromHex("00F5FF"), 
        Color3.fromHex("C86BFF") 
    ),
    Draggable = true,
})

local Tabs = {}

do
    Tabs.Info = Window:Tab({ Title = "Info", Icon = "rbxassetid://7733964719" })
    Tabs.Main = Window:Tab({ Title = "Main", Icon = "rbxassetid://7733960981" })
    Tabs.Door = Window:Tab({ Title = "Door", Icon = "rbxassetid://7734058345" })
    Tabs.Config = Window:Tab({ Title = "Config", Icon = "file-cog" })
end

Window:SelectTab(1)

Tabs.Info:Section({Title = "Ultimate Mining Tycoon"})
Tabs.Info:Paragraph({
    Title = "Author: TienThanh",
    Desc = "V1.1.0"
})




Tabs.Main:Section({Title = "Ores"})
Tabs.Main:Dropdown({
    Title = "Select Ore",
    Values = getOreNames(),
    Desc = "Chọn 1 ore",
    Callback = function(opt)
        Configs.select = opt
        if Configs.esp then
            OreESP(opt)
        end
    end
})



Tabs.Main:Toggle({
    Title = "Esp ore",
    Desc = "Hiển thị vị trí ore",
    Default = false,
    Callback = function(state)
        Configs.esp = state
        if state then
            OreESP(Configs.select)
        else
            if espCon then espCon:Disconnect() espCon = nil end
            clearESP()
        end
    end
})




-- Tabs.Main:Section({Title = "Auto"})
-- Tabs.Main:Toggle({
--     Title = "Auto Farm",
--     Desc = "Bật/Tắt - Farm",
--     Default = false,
--     Callback = function(state) 
--         if state then 
--         end
--     end
-- })

Tabs.Main:Button({
    Title = "Sell Ore",
    Default = false,
    Callback = function() 

local p = game.Players.LocalPlayer
local c = p.Character or p.CharacterAdded:Wait()
local h = c:WaitForChild("HumanoidRootPart")
local oldpos = h.CFrame

tp(p, workspace.Placeables[plotid].UnloaderSystem.Unloader.Hitbox)

local a = p:WaitForChild("PlayerGui"):WaitForChild("ProximityPrompts")
    :WaitForChild("Prompt").Frame.TextFrame:WaitForChild("ActionText")
local v = game:GetService("VirtualInputManager")

repeat
    if a.Text == "Add Items" and a.Visible then
        v:SendKeyEvent(true, Enum.KeyCode.E, false, game)
        task.wait(0.03)
        v:SendKeyEvent(false, Enum.KeyCode.E, false, game)
    end
    task.wait(0.1)
until a.Text ~= "Add Items" or not a.Visible

h.CFrame = oldpos

    end
})


Tabs.Main:Section({Title = "Teleport Ore"})
Tabs.Main:Button({
    Title = "Auto TP",
    Default = false,
    Callback = function() 
        tp(game.Players.LocalPlayer,workspace.PlacedOre:GetChildren()[math.random(1, #workspace.PlacedOre:GetChildren())])
    end
})


Tabs.Main:Section({Title = "Fly Ore"})
Tabs.Main:Toggle({ 
    Title = "Auto Fly",
    Desc = "Tắt nếu muốn dừng bay",
    Default = false,
    Callback = function(state)
        if state then 
            flyToOre()
        else
            run = false 
        end
    end
})




Tabs.Door:Section({Title = "Home"})
Tabs.Door:Button({
    Title = "Back Home",
    Desc = "Quay về",
    Callback = function()
        tp(game.Players.LocalPlayer,workspace.Plots[plotid].Centre)
    end
})



Tabs.Door:Section({Title = "Farm Location"})
Tabs.Door:Button({
    Title = "Dịch chuyển tới vị trí farm",
    Callback = function() tp(game.Players.LocalPlayer,CFrame.new(-1853.91711, 4.88865042, -179.539627, 1, 0, 0, 0, 1, 0, 0, 0, 1)) end
})


Tabs.Door:Section({Title = "Store"})
Tabs.Door:Dropdown({
    Title = "Select NPC",
    Values = {"Backpack Store","Explosives Store","Pickaxe Store","Rebirth Store"},
    Desc = "NPC",
    Callback = function(opt)
        
        tp(game.Players.LocalPlayer,workspace[opt])
    end
})





Tabs.Config:Section({Title = "Features"})
Tabs.Config:Button({
    Title = "Anti AFK",
    Desc = "Tránh mất kết nối roblox",
    Callback = function()
        local vu = game:GetService("VirtualUser")
        game.Players.LocalPlayer.Idled:Connect(function()
            vu:Button2Down(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
            task.wait(1)
            vu:Button2Up(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
        end)
    end
})

Tabs.Config:Button({
    Title = "Roblox FPS Booster",
    Desc = "Giảm lag trò chơi",
    Callback = function()
        loadstring(game:HttpGet('https://raw.githubusercontent.com/vexroxd/My-Script-/main/roblox%20fps%20unlocker%20script.lua'))()
    end
})


Tabs.Config:Section({Title = "Speed"})
Tabs.Config:Slider({
    Title = "Walk Speed",
    Step = 1,
    Value = {
        Min = 16,
        Max = 1000,
        Default = 16,
    },
    Callback = function(value)
        Configs.walkspeed = value
        local char = game.Players.LocalPlayer.Character
        if char then
            local hum = char:FindFirstChildOfClass("Humanoid")
            if hum then
                hum.WalkSpeed = value
            end
        end
    end
})
Tabs.Config:Slider({
    Title = "Fly Speed",
    Step = 5,
    Value = {Min = 50, Max = 1000, Default = 100},
    Callback = function(v)
        Configs.flyspeed = v
    end
})
